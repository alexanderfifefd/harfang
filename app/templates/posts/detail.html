{% extends "base_page.html" %}

{% load i18n %}

{% block content %}
    <article itemid="{% url 'post' post.id %}"
             itemscope
             itemtype="https://schema.org/DiscussionForumPosting">
        <header class="max-w-none prose">
            <hgroup>
                <h1 itemprop="headline">
                    <a href="{% url 'post' post.id %}" class="no-link">{{ post.title }}</a>
                </h1>
                <p>
                    {% blocktranslate trimmed with age=post.submit_date|timesince %}
                        Posted {{ age }} ago
                    {% endblocktranslate %}
                    {% translate "by" %}
                    {% include "partials/profile_link.html" with username=post.user.username %}
                </p>
                <p>
                    <a href="{{ post.url }}" target="_blank" rel="noreferrer">{% translate "Link" %}</a>
                    <link href="{{ post.url }}">
                </p>
            </hgroup>
            {{ post.body|linebreaks }}
        </header>
        <br>
        <br>
        <section class="max-w-none prose" hx-vals='{"tree": true}'>
            {% if form %}
                <div hx-target="#comment-tree" hx-swap="beforeend" hx-push-url="false">
                    {% include "comments/form.html" %}
                </div>
            {% else %}
                <p>
                    {% translate "Log in to join the discussion." %}
                </p>
            {% endif %}
            <h3>
                {% translate "Comments" %} ({{ post.comments.count }})
            </h3>
            {% include "comments/tree.html" %}
        </section>
    </article>
{% endblock content %}
